<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>不是在改BUG，就是在改BUG的路上 - CPU 平均工作负载</title>

      
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://blog.kiyoko.io/atom.xml">
      

      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
          
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">

          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js" integrity="sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy" crossorigin="anonymous"></script>
              
          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"
                  onload="renderMathInElement(document.body);"></script>
              
          
      

      
          <link rel="stylesheet" href="https://blog.kiyoko.io/site.css">
          
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">三天打鱼</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;blog.kiyoko.io">
                            Home
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;categories">
                            Categories
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;tags">
                            Tags
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;about">
                            About
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;blog.kiyoko.io">三天打鱼</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;blog.kiyoko.io">
                                    Home
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;categories">
                                    Categories
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;tags">
                                    Tags
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;about">
                                    About
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    


<div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content always-active">
        <nav id="TableOfContents">
            <ul>
                
                <li>
                    <a href="https://blog.kiyoko.io/load-average/#shi-yao-shi-ping-jun-fu-zai" class="toc-link">什么是平均负载</a>
                    
                </li>
                
                <li>
                    <a href="https://blog.kiyoko.io/load-average/#ping-gu-ping-jun-fu-zai" class="toc-link">评估平均负载</a>
                    
                </li>
                
                <li>
                    <a href="https://blog.kiyoko.io/load-average/#ping-jun-fu-zai-yu-cpu-shi-yong-lu" class="toc-link">平均负载与 CPU 使用率</a>
                    
                </li>
                
                <li>
                    <a href="https://blog.kiyoko.io/load-average/#an-li-fen-xi" class="toc-link">案例分析</a>
                    
                    <ul>
                        
                        <li>
                            <a href="https://blog.kiyoko.io/load-average/#an-zhuang-gong-ju" class="toc-link">安装工具</a>
                        </li>
                        
                        <li>
                            <a href="https://blog.kiyoko.io/load-average/#cpu-mi-ji-xing" class="toc-link">CPU 密集型</a>
                        </li>
                        
                        <li>
                            <a href="https://blog.kiyoko.io/load-average/#i-o-mi-ji-xing" class="toc-link">I&#x2F;O 密集型</a>
                        </li>
                        
                        <li>
                            <a href="https://blog.kiyoko.io/load-average/#da-liang-jin-cheng" class="toc-link">大量进程</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    <a href="https://blog.kiyoko.io/load-average/#can-kao-yue-du" class="toc-link">参考阅读</a>
                    
                </li>
                
            </ul>
        </nav>
    </div>
</div>


<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;load-average&#x2F;">CPU 平均工作负载</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2020-08-22</span>
            
        </div>
    </header>

    <div class="post-content">
      <p>当程序的性能未达到预期时，大多数开发者会选择使用 <code>top</code> 指令查看指标 <code>CPU</code> 使用率。其实，还有另一个有关 <code>CPU</code> 的重要指标: 平均负责 <code>(load average)</code>。</p>
<p>可以使用 <code>top</code> 指令，或者 <code>uptime</code> 指令查看:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span>$</span><span style="color:#bf616a;">top
</span><span>
</span><span style="color:#bf616a;">top</span><span> - 23:11:02 up 19 days, 12:05,  1 user,  load average: 1.25, 1.42, 1.29
</span><span style="color:#bf616a;">Tasks:</span><span> 258 total,   2 running, 197 sleeping,   0 stopped,   0 zombie
</span><span>%</span><span style="color:#bf616a;">Cpu</span><span>(s)</span><span style="color:#96b5b4;">:</span><span>  9.1 us,  6.8 sy,  0.3 ni, 78.1 id,  5.2 wa,  0.0 hi,  0.5 si,  0.0 st
</span><span style="color:#bf616a;">KiB</span><span> Mem : 15871204 total,   508880 free,  1675924 used, 13686400 buff/cache
</span><span style="color:#bf616a;">KiB</span><span> Swap:  2097148 total,  2096112 free,     1036 used. 14133480 avail Mem
</span><span>
</span><span>  </span><span style="color:#bf616a;">PID</span><span> USER      PR  NI    VIRT    RES    SHR S  %</span><span style="color:#bf616a;">CPU </span><span>%</span><span style="color:#bf616a;">MEM</span><span>     TIME+ COMMAND
</span><span> </span><span style="color:#bf616a;">4812</span><span> root      20   0  271208 155208  36668 S  14.6  1.0   1078:57 rancher
</span><span style="color:#bf616a;">...
</span></code></pre>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> uptime
</span><span> </span><span style="color:#bf616a;">23:10:12</span><span> up 19 days, 12:05,  1 user,  load average: 1.65, 1.50, 1.31
</span></code></pre>
<p>可以发现，<code>uptime</code> 指令的输出与 <code>top</code> 指令输出的第一行几乎一致。具体每一部分的含义为:</p>
<ul>
<li><strong>当前时间</strong>: 23:10:12</li>
<li><strong>运行时间</strong>: up 19 days, 12:05</li>
<li><strong>登录用户数量</strong>: 1 user</li>
<li><strong>平均负载</strong>: 过去 <strong>1min</strong>，<strong>3min</strong>，<strong>5min</strong> 的平均负载</li>
</ul>
<h2 id="shi-yao-shi-ping-jun-fu-zai">什么是平均负载</h2>
<p>首先，需要强调:</p>
<ul>
<li><strong>平均负载不等于 <code>CPU</code> 使用率！！！</strong></li>
<li><strong>平均负载不等于 <code>CPU</code> 使用率！！！</strong></li>
<li><strong>平均负载不等于 <code>CPU</code> 使用率！！！</strong></li>
</ul>
<p>而是，系统处于 <strong>可运行状态</strong> 和 <strong>不可中断状态</strong> 的平均进程数，即 <strong>平均活跃进程数</strong>。与 <code>CPU</code> 使用率没有直接关系。</p>
<ul>
<li><strong>可运行状态</strong>: 正在使用 <code>CPU</code> 或者正在等待 <code>CPU</code> 的进程。即 <code>ps</code> 指令显示为 <code>R</code> 状态 <code>(Running/Runable)</code> 的进程。</li>
<li><strong>不可中断状态</strong>: 处于内核态关键流程中的进程，且不可打断。比如最常见的是等待硬件设备的 <code>I/O</code> 响应，即 <code>ps</code> 指令中中看到的 <code>D</code> 状态 <code>(Uninterruptible Sleep/Disk Sleep)</code> 的进程。</li>
</ul>
<p>比如，当一个进程向磁盘读写数据时，为了保证数据的一致性，在得到磁盘回复前，它是不能被其他 <strong>进程</strong> 或者 <strong>中断</strong> 打断的，这个时候的进程就处于不可中断状态。如果此时的进程被打断了，就容易出现磁盘数据与进程数据不一致的问题。</p>
<p>所以，<strong>不可中断状态实际上是系统对进程和硬件设备的一种保护机制</strong>。</p>
<h2 id="ping-gu-ping-jun-fu-zai">评估平均负载</h2>
<p>可以简单的认为，平均负载就是活跃的进程数。所以，最理想的场景是每个 <code>CPU</code> 都只需要处理一个进程，即 <code>CPU</code> 数量等于平均负载值。</p>
<p>因此，在分析系统平均负载是否合理时，首先应该知道当前系统的 <code>CPU</code> 数量。</p>
<p>平均负载可以简单的认为是活跃进程数:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> cat /proc/cpuinfo | </span><span style="color:#bf616a;">grep -i </span><span>&#39;</span><span style="color:#a3be8c;">model name</span><span>&#39; | </span><span style="color:#bf616a;">wc -l
</span><span style="color:#bf616a;">16
</span></code></pre>
<p>之后，就可以通过比较 <code>CPU</code> 的数量与平均负载大小关系，确认系统是否过载。</p>
<p>同时，结合过去 <code>1min</code>，<code>5min</code>，<code>15min</code> 的系统负载，就可以推测出系统负载的变化趋势。</p>
<p>当平均负载超过 <code>CPU</code> <code>50%</code> 时，可以认为负载较高；当超过 <code>70%</code> 时，就应该开发分析导致高负载的原因。同时，也应该将平均负载作为一项监控指标。只有结合历史数据来分析才更有意义。</p>
<h2 id="ping-jun-fu-zai-yu-cpu-shi-yong-lu">平均负载与 CPU 使用率</h2>
<p><strong>平均负载</strong> 表示为一定时间内，处于 <strong>可运行状态</strong> 和 <strong>不可中断状态</strong> 的进程数量。核心在于 <strong>进程数量</strong>。</p>
<ul>
<li><code>R</code> 状态: 运行状态，会使用到 <code>CPU</code></li>
<li><code>D</code> 状态: 不可中断状态，处于内核态等待 <code>I/O</code> 响应，不使用 <code>CPU</code>。</li>
</ul>
<p><strong><code>CPU</code> 使用率</strong> 表示为一定时间内 <code>CPU</code> 的繁忙情况。核心在于进程占用 <code>CPU</code> 的时间占总时间的百分比。</p>
<p>因此，应该将二者结合一起使用:</p>
<ul>
<li><code>CPU</code> 密集型进程，使用大量 <code>CPU</code> 会导致平均负载升高，此时这两者是一致的</li>
<li><code>I/O</code> 密集型进程，等待 <code>I/O</code> 会导致平均负载升高，但 <code>CPU</code> 使用率不一定很高</li>
<li>大量等待 <code>CPU</code> 的进程调度也会导致平均负载升高，此时的 <code>CPU</code> 使用率也会比较高。</li>
</ul>
<h2 id="an-li-fen-xi">案例分析</h2>
<p>系统初始状态为:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> uptime
</span><span> </span><span style="color:#bf616a;">16:39:57</span><span> up 1 day,  2:52,  0 users,  load average: 0.10, 0.05, 0.06
</span></code></pre>
<h3 id="an-zhuang-gong-ju">安装工具</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">sudo</span><span> pacman</span><span style="color:#bf616a;"> -S</span><span> stress sysstat
</span></code></pre>
<h3 id="cpu-mi-ji-xing">CPU 密集型</h3>
<p>首先，在 <code>Terminal No.1</code> 使用 <code>stress</code> 模拟一个 <code>CPU</code> 密集型进程:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> stress</span><span style="color:#bf616a;"> --cpu</span><span> 1</span><span style="color:#bf616a;"> --timeout</span><span> 6000
</span><span style="color:#bf616a;">stress:</span><span> info: </span><span style="color:#b48ead;">[</span><span>5049</span><span style="color:#b48ead;">]</span><span> dispatching hogs: 1 cpu, 0 io, 0 vm, 0 hdd
</span></code></pre>
<p>然后，在 <code>Terminal No.2</code> 查看平均负载:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> watch</span><span style="color:#bf616a;"> -d</span><span> uptime
</span><span style="color:#bf616a;">Every</span><span> 2.0s: uptime                zephyrus: Sun Aug 23 16:44:30 2020
</span><span>
</span><span> </span><span style="color:#bf616a;">16:44:30</span><span> up 1 day,  2:56,  0 users,  load average: 0.99, 0.62, 0.30
</span></code></pre>
<p>可以观察到，<code>1min</code> 的平均负载有较大的变化。</p>
<p>接着，在 <code>Terminal No.3</code> 监控 <code>CPU</code>:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> mpstat</span><span style="color:#bf616a;"> -P</span><span> ALL 5
</span><span style="color:#bf616a;">Linux</span><span> 4.19.104-microsoft-standard (zephyrus)    </span><span style="color:#bf616a;">08/23/2020</span><span>      _x86_64_        (16 CPU)
</span><span>
</span><span style="color:#bf616a;">04:44:59</span><span> PM  CPU    %</span><span style="color:#bf616a;">usr   </span><span>%</span><span style="color:#bf616a;">nice    </span><span>%</span><span style="color:#bf616a;">sys </span><span>%</span><span style="color:#bf616a;">iowait    </span><span>%</span><span style="color:#bf616a;">irq   </span><span>%</span><span style="color:#bf616a;">soft  </span><span>%</span><span style="color:#bf616a;">steal  </span><span>%</span><span style="color:#bf616a;">guest  </span><span>%</span><span style="color:#bf616a;">gnice   </span><span>%</span><span style="color:#bf616a;">idle
</span><span style="color:#bf616a;">04:45:04</span><span> PM  all    6.29    0.00    0.06    0.00    0.00    0.08    0.00    0.00    0.00   93.57
</span><span style="color:#bf616a;">04:45:04</span><span> PM    0    0.00    0.00    0.00    0.00    0.00    1.19    0.00    0.00    0.00   98.81
</span><span style="color:#bf616a;">04:45:04</span><span> PM    1  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM    2    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
</span><span style="color:#bf616a;">04:45:04</span><span> PM    3    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM    4    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM    5    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM    6    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
</span><span style="color:#bf616a;">04:45:04</span><span> PM    7    0.40    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.60
</span><span style="color:#bf616a;">04:45:04</span><span> PM    8    0.00    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.60
</span><span style="color:#bf616a;">04:45:04</span><span> PM    9    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM   10    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
</span><span style="color:#bf616a;">04:45:04</span><span> PM   11    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM   12    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
</span><span style="color:#bf616a;">04:45:04</span><span> PM   13    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM   14    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">04:45:04</span><span> PM   15    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span></code></pre>
<p><code>#1 CPU</code> 的 <code>%usr</code> 使用率为 <code>100。00</code>，而 <code>%sys</code> 与 <code>%iowait</code> 都是 <code>0.00</code>，说明 <code>#1 CPU</code> 正在处理 <code>CPU</code> 密集型的任务。</p>
<p>最后，在 <code>Terminal No.4</code> 中查找占用 <code>CPU</code> 的进程:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> pidstat</span><span style="color:#bf616a;"> -u</span><span> 5 1
</span><span style="color:#bf616a;">Linux</span><span> 4.19.104-microsoft-standard (zephyrus)    </span><span style="color:#bf616a;">08/23/2020</span><span>      _x86_64_        (16 CPU)
</span><span>
</span><span style="color:#bf616a;">04:46:58</span><span> PM   UID       PID    %</span><span style="color:#bf616a;">usr </span><span>%</span><span style="color:#bf616a;">system  </span><span>%</span><span style="color:#bf616a;">guest   </span><span>%</span><span style="color:#bf616a;">wait    </span><span>%</span><span style="color:#bf616a;">CPU</span><span>   CPU  Command
</span><span style="color:#bf616a;">04:47:03</span><span> PM   977      5050  100.00    0.00    0.00    0.00  100.00     1  stress
</span><span style="color:#bf616a;">04:47:03</span><span> PM   977      5054    0.00    0.20    0.00    0.00    0.20     4  watch
</span><span>
</span><span style="color:#bf616a;">Average:</span><span>      UID       PID    %</span><span style="color:#bf616a;">usr </span><span>%</span><span style="color:#bf616a;">system  </span><span>%</span><span style="color:#bf616a;">guest   </span><span>%</span><span style="color:#bf616a;">wait    </span><span>%</span><span style="color:#bf616a;">CPU</span><span>   CPU  Command
</span><span style="color:#bf616a;">Average:</span><span>      977      5050  100.00    0.00    0.00    0.00  100.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      5054    0.00    0.20    0.00    0.00    0.20     -  watch
</span></code></pre>
<p>确认 <code>pid=5050</code> 的 <code>stress</code> 进程占用了 <code>100%</code> 的 <code>CPU</code>。</p>
<h3 id="i-o-mi-ji-xing">I/O 密集型</h3>
<p>等待一段时间，平均负载恢复正常之后。</p>
<p>首先，在 <code>Terminal No.1</code> 使用 <code>stress</code> 模拟一个 <code>I/O</code> 密集型进程:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> stress</span><span style="color:#bf616a;"> -i</span><span> 1
</span><span style="color:#bf616a;">stress:</span><span> info: </span><span style="color:#b48ead;">[</span><span>7126</span><span style="color:#b48ead;">]</span><span> dispatching hogs: 0 cpu, 1 io, 0 vm, 0 hdd
</span></code></pre>
<p>然后，在 <code>Terminal No.2</code> 查看平均负载:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> watch</span><span style="color:#bf616a;"> -d</span><span> uptime
</span><span style="color:#bf616a;">Every</span><span> 2.0s: uptime                zephyrus: Sun Aug 23 17:11:31 2020
</span><span>
</span><span> </span><span style="color:#bf616a;">17:11:31</span><span> up 1 day,  3:23,  0 users,  load average: 0.98, 0.60, 0.54
</span></code></pre>
<p><code>1min</code> 的平均负载有所增加。</p>
<p>接着，在 <code>Terminal No.3</code> 监控 <code>CPU</code>:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> mpstat</span><span style="color:#bf616a;"> -P</span><span> ALL 5
</span><span style="color:#bf616a;">Linux</span><span> 4.19.104-microsoft-standard (zephyrus)    </span><span style="color:#bf616a;">08/23/2020</span><span>      _x86_64_        (16 CPU)
</span><span>
</span><span style="color:#bf616a;">05:11:53</span><span> PM  CPU    %</span><span style="color:#bf616a;">usr   </span><span>%</span><span style="color:#bf616a;">nice    </span><span>%</span><span style="color:#bf616a;">sys </span><span>%</span><span style="color:#bf616a;">iowait    </span><span>%</span><span style="color:#bf616a;">irq   </span><span>%</span><span style="color:#bf616a;">soft  </span><span>%</span><span style="color:#bf616a;">steal  </span><span>%</span><span style="color:#bf616a;">guest  </span><span>%</span><span style="color:#bf616a;">gnice   </span><span>%</span><span style="color:#bf616a;">idle
</span><span style="color:#bf616a;">05:11:58</span><span> PM  all    0.09    0.00    0.64    0.01    0.00    0.05    0.00    0.00    0.00   99.21
</span><span style="color:#bf616a;">05:11:58</span><span> PM    0    0.00    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.59
</span><span style="color:#bf616a;">05:11:58</span><span> PM    1    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM    2    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
</span><span style="color:#bf616a;">05:11:58</span><span> PM    3    0.00    0.00    6.76    0.20    0.00    0.00    0.00    0.00    0.00   93.04
</span><span style="color:#bf616a;">05:11:58</span><span> PM    4    0.00    0.00    0.43    0.00    0.00    0.65    0.00    0.00    0.00   98.92
</span><span style="color:#bf616a;">05:11:58</span><span> PM    5    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
</span><span style="color:#bf616a;">05:11:58</span><span> PM    6    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM    7    1.00    0.00    1.40    0.00    0.00    0.00    0.00    0.00    0.00   97.60
</span><span style="color:#bf616a;">05:11:58</span><span> PM    8    0.00    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.60
</span><span style="color:#bf616a;">05:11:58</span><span> PM    9    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM   10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM   11    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM   12    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM   13    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
</span><span style="color:#bf616a;">05:11:58</span><span> PM   14    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
</span><span style="color:#bf616a;">05:11:58</span><span> PM   15    0.20    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.40
</span></code></pre>
<p>很遗憾，相比于 <code>CPU</code> 密集型的测试，<code>I/O</code> 本次测试的 <code>CPU</code> 变化不是特别明显。不过，还是可以发现 <code>#3 CPU</code> 的数据与其他 <code>CPU</code> 有一定的差别。</p>
<ol>
<li><code>%idle</code> 为 <code>93.04</code>，而其他的 <code>CPU</code> 该项数值均处于较高的水平</li>
<li><code>%sys</code> 为 <code>6.76</code>，远高于其他 <code>CPU</code></li>
<li><code>%iowait</code> 为 <code>0.20</code>，相对于其他 <code>CPU</code> 最高只有 <code>0.01</code>，可谓是高出了 <code>2000%</code></li>
</ol>
<p>最后，使用 <code>pidstat</code> 查找具体进程:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> pidstat</span><span style="color:#bf616a;"> -u</span><span> 5 1
</span><span style="color:#bf616a;">Linux</span><span> 4.19.104-microsoft-standard (zephyrus)    </span><span style="color:#bf616a;">08/23/2020</span><span>      _x86_64_        (16 CPU)
</span><span>
</span><span style="color:#bf616a;">05:13:36</span><span> PM   UID       PID    %</span><span style="color:#bf616a;">usr </span><span>%</span><span style="color:#bf616a;">system  </span><span>%</span><span style="color:#bf616a;">guest   </span><span>%</span><span style="color:#bf616a;">wait    </span><span>%</span><span style="color:#bf616a;">CPU</span><span>   CPU  Command
</span><span style="color:#bf616a;">05:13:41</span><span> PM   977      3196    0.20    0.00    0.00    0.00    0.20     7  node
</span><span style="color:#bf616a;">05:13:41</span><span> PM   977      7127    0.00   15.00    0.00    0.20   15.00     3  stress
</span><span>
</span><span style="color:#bf616a;">Average:</span><span>      UID       PID    %</span><span style="color:#bf616a;">usr </span><span>%</span><span style="color:#bf616a;">system  </span><span>%</span><span style="color:#bf616a;">guest   </span><span>%</span><span style="color:#bf616a;">wait    </span><span>%</span><span style="color:#bf616a;">CPU</span><span>   CPU  Command
</span><span style="color:#bf616a;">Average:</span><span>      977      3196    0.20    0.00    0.00    0.00    0.20     -  node
</span><span style="color:#bf616a;">Average:</span><span>      977      7127    0.00   15.00    0.00    0.20   15.00     -  stress
</span></code></pre>
<p>发现 <code>stress</code> 进程的指标为 <code>%system = 15.00</code>，<code>%wait = 0.20</code>，<code>%CPU = 15.00</code>。</p>
<h3 id="da-liang-jin-cheng">大量进程</h3>
<p>因为，测试机有 16 个 <code>CPU</code> 核心，所以，在 <code>Terminal 1</code> 上模拟 <code>64</code> 个进程:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> stress</span><span style="color:#bf616a;"> -c</span><span> 64</span><span style="color:#bf616a;"> --timeout</span><span> 6000
</span><span style="color:#bf616a;">stress:</span><span> info: </span><span style="color:#b48ead;">[</span><span>7847</span><span style="color:#b48ead;">]</span><span> dispatching hogs: 64 cpu, 0 io, 0 vm, 0 hdd
</span></code></pre>
<p>然后，在 <code>Terminal 2</code> 上查看平均负载:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> watch</span><span style="color:#bf616a;"> -d</span><span> uptime
</span><span style="color:#bf616a;">Every</span><span> 2.0s: uptime                      zephyrus: Sun Aug 23 17:32:28 2020
</span><span>
</span><span> </span><span style="color:#bf616a;">17:32:28</span><span> up 1 day,  3:44,  0 users,  load average: 62.89, 35.44, 14.80
</span></code></pre>
<p>接着，在 <code>Terminal 3</code> 查看 <code>CPU</code> 的状态:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> mpstat</span><span style="color:#bf616a;"> -P</span><span> ALL 5
</span><span style="color:#bf616a;">Linux</span><span> 4.19.104-microsoft-standard (zephyrus)    </span><span style="color:#bf616a;">08/23/2020</span><span>      _x86_64_        (16 CPU)
</span><span>
</span><span style="color:#bf616a;">05:31:42</span><span> PM  CPU    %</span><span style="color:#bf616a;">usr   </span><span>%</span><span style="color:#bf616a;">nice    </span><span>%</span><span style="color:#bf616a;">sys </span><span>%</span><span style="color:#bf616a;">iowait    </span><span>%</span><span style="color:#bf616a;">irq   </span><span>%</span><span style="color:#bf616a;">soft  </span><span>%</span><span style="color:#bf616a;">steal  </span><span>%</span><span style="color:#bf616a;">guest  </span><span>%</span><span style="color:#bf616a;">gnice   </span><span>%</span><span style="color:#bf616a;">idle
</span><span style="color:#bf616a;">05:31:47</span><span> PM  all   99.92    0.00    0.07    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    0   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    1  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    2  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    3   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    4  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    5  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    6   99.60    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    7  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    8  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM    9  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM   10  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM   11  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM   12   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM   13  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM   14   99.80    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span><span style="color:#bf616a;">05:31:47</span><span> PM   15  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00
</span></code></pre>
<p>所有的 <code>CPU</code> 都处于满负载工作状态，除了 <code>%usr</code> 之外，只有 <code>%sys</code> 有少量数值。</p>
<p>最后，在 <code>Terminal 4</code> 查看进程状态:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> pidstat</span><span style="color:#bf616a;"> -u</span><span> 5 1
</span><span style="color:#bf616a;">Linux</span><span> 4.19.104-microsoft-standard (zephyrus)    </span><span style="color:#bf616a;">08/23/2020</span><span>      _x86_64_        (16 CPU)
</span><span>
</span><span style="color:#bf616a;">05:33:00</span><span> PM   UID       PID    %</span><span style="color:#bf616a;">usr </span><span>%</span><span style="color:#bf616a;">system  </span><span>%</span><span style="color:#bf616a;">guest   </span><span>%</span><span style="color:#bf616a;">wait    </span><span>%</span><span style="color:#bf616a;">CPU</span><span>   CPU  Command
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7848   25.00    0.00    0.00   75.00   25.00     4  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7849   25.00    0.00    0.00   74.60   25.00     3  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7850   25.00    0.00    0.00   74.40   25.00     9  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7851   25.00    0.00    0.00   75.00   25.00    13  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7852   25.00    0.00    0.00   75.20   25.00    15  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7853   24.80    0.00    0.00   75.20   24.80     6  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7854   24.80    0.20    0.00   75.40   25.00     0  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7855   25.00    0.00    0.00   74.80   25.00     4  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7856   25.00    0.00    0.00   75.20   25.00     6  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7857   25.20    0.00    0.00   75.20   25.20     9  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7858   25.00    0.00    0.00   75.00   25.00    10  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7859   25.00    0.00    0.00   75.00   25.00    13  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7860   25.00    0.00    0.00   75.00   25.00    15  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7861   25.00    0.00    0.00   75.00   25.00     1  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7863   25.00    0.00    0.00   75.00   25.00     5  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7864   25.00    0.00    0.00   75.40   25.00     7  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7865   25.00    0.00    0.00   75.00   25.00     3  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7866   25.00    0.00    0.00   75.00   25.00    11  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7867   24.80    0.00    0.00   75.00   24.80     2  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7868   24.80    0.00    0.00   75.00   24.80    14  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7869   25.00    0.00    0.00   74.80   25.00     0  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7870   25.00    0.00    0.00   75.00   25.00     5  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7871   25.00    0.00    0.00   74.40   25.00     6  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7872   25.00    0.00    0.00   75.20   25.00     9  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7873   24.80    0.00    0.00   75.40   24.80    10  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7874   25.00    0.00    0.00   75.40   25.00    12  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7875   25.00    0.00    0.00   75.00   25.00    15  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7876   25.00    0.00    0.00   75.00   25.00     1  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7877   24.60    0.20    0.00   75.00   24.80     2  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7878   25.00    0.00    0.00   75.40   25.00     7  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7879   24.80    0.00    0.00   75.60   24.80     8  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7880   25.00    0.00    0.00   75.00   25.00    11  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7881   25.00    0.00    0.00   75.00   25.00    12  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7882   25.00    0.00    0.00   75.80   25.00    14  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7883   25.20    0.00    0.00   74.80   25.20     1  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7884   25.00    0.00    0.00   75.00   25.00     4  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7885   25.00    0.00    0.00   75.20   25.00     6  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7886   25.00    0.00    0.00   74.80   25.00     8  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7887   25.00    0.00    0.00   75.40   25.00    11  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7888   25.20    0.00    0.00   74.80   25.20    12  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7889   24.80    0.00    0.00   75.20   24.80     2  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7890   24.80    0.00    0.00   75.20   24.80     0  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7891   25.00    0.00    0.00   74.80   25.00     5  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7892   25.00    0.00    0.00   75.40   25.00     3  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7893   25.00    0.00    0.00   74.80   25.00     8  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7894   25.20    0.00    0.00   74.60   25.20    10  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7895   25.00    0.00    0.00   75.20   25.00    13  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7896   25.00    0.00    0.00   75.00   25.00    14  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7897   24.80    0.00    0.00   75.60   24.80     2  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7898   25.00    0.00    0.00   74.80   25.00     7  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7899   24.80    0.00    0.00   75.20   24.80     8  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7900   25.00    0.00    0.00   74.80   25.00    10  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7901   25.00    0.00    0.00   74.80   25.00    13  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7902   24.80    0.00    0.00   74.80   24.80    14  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7903   24.80    0.00    0.00   75.20   24.80     1  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7904   25.00    0.00    0.00   74.80   25.00     3  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7905   24.80    0.00    0.00   75.00   24.80     4  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7906   25.00    0.00    0.00   75.00   25.00     7  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7907   24.80    0.00    0.00   75.00   24.80     9  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7908   25.00    0.00    0.00   74.40   25.00    11  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7909   25.00    0.00    0.00   75.20   25.00    12  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7910   25.00    0.00    0.00   75.00   25.00    15  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7911   25.00    0.00    0.00   74.80   25.00     0  stress
</span><span style="color:#bf616a;">05:33:05</span><span> PM   977      7912   25.00    0.00    0.00   75.20   25.00     5  stress
</span><span>
</span><span style="color:#bf616a;">Average:</span><span>      UID       PID    %</span><span style="color:#bf616a;">usr </span><span>%</span><span style="color:#bf616a;">system  </span><span>%</span><span style="color:#bf616a;">guest   </span><span>%</span><span style="color:#bf616a;">wait    </span><span>%</span><span style="color:#bf616a;">CPU</span><span>   CPU  Command
</span><span style="color:#bf616a;">Average:</span><span>      977      7848   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7849   25.00    0.00    0.00   74.60   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7850   25.00    0.00    0.00   74.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7851   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7852   25.00    0.00    0.00   75.20   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7853   24.80    0.00    0.00   75.20   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7854   24.80    0.20    0.00   75.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7855   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7856   25.00    0.00    0.00   75.20   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7857   25.20    0.00    0.00   75.20   25.20     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7858   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7859   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7860   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7861   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7863   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7864   25.00    0.00    0.00   75.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7865   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7866   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7867   24.80    0.00    0.00   75.00   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7868   24.80    0.00    0.00   75.00   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7869   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7870   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7871   25.00    0.00    0.00   74.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7872   25.00    0.00    0.00   75.20   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7873   24.80    0.00    0.00   75.40   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7874   25.00    0.00    0.00   75.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7875   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7876   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7877   24.60    0.20    0.00   75.00   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7878   25.00    0.00    0.00   75.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7879   24.80    0.00    0.00   75.60   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7880   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7881   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7882   25.00    0.00    0.00   75.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7883   25.20    0.00    0.00   74.80   25.20     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7884   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7885   25.00    0.00    0.00   75.20   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7886   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7887   25.00    0.00    0.00   75.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7888   25.20    0.00    0.00   74.80   25.20     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7889   24.80    0.00    0.00   75.20   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7890   24.80    0.00    0.00   75.20   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7891   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7892   25.00    0.00    0.00   75.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7893   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7894   25.20    0.00    0.00   74.60   25.20     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7895   25.00    0.00    0.00   75.20   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7896   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7897   24.80    0.00    0.00   75.60   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7898   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7899   24.80    0.00    0.00   75.20   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7900   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7901   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7902   24.80    0.00    0.00   74.80   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7903   24.80    0.00    0.00   75.20   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7904   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7905   24.80    0.00    0.00   75.00   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7906   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7907   24.80    0.00    0.00   75.00   24.80     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7908   25.00    0.00    0.00   74.40   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7909   25.00    0.00    0.00   75.20   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7910   25.00    0.00    0.00   75.00   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7911   25.00    0.00    0.00   74.80   25.00     -  stress
</span><span style="color:#bf616a;">Average:</span><span>      977      7912   25.00    0.00    0.00   75.20   25.00     -  stress
</span></code></pre>
<p>64 个进程，基本都占用了 <code>25%</code> 的 <code>CPU</code> 使用率。与设想中的一致，每个 <code>CPU</code> 核心要服务于 4 个进程。</p>
<h2 id="can-kao-yue-du">参考阅读</h2>
<p><a href="https://jingwei.link/2018/12/23/linux-cpu-load-d-process.html">Linux的CPU-Load虚高之进程的D状态</a>
<a href="https://www.cnblogs.com/gatsby123/p/11127158.html">CPU使用率原理及计算方式</a>
<a href="https://www.cnblogs.com/xiaotengyi/p/7644336.html">Linux 进程的 Uninterruptible sleep(D) 状态</a>
<a href="https://blog.csdn.net/wudebao5220150/article/details/12919453">Linux进程状态解析</a></p>

    </div>

    
    

    <div class="post-footer">
        
            
                <div class="post-tags">
                    
                        <a href="https://blog.kiyoko.io/tags/linux-performance/">#linux performance</a>
                    
                        <a href="https://blog.kiyoko.io/tags/cpu-performance/">#cpu performance</a>
                    
                </div>
            
            
                <div class="post-nav">
                    
                        <a class="previous" href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;linux-performance-guide&#x2F;">‹ Linux 性能调优指南</a>
                    
                    
                        <a class="next" href="https:&#x2F;&#x2F;blog.kiyoko.io&#x2F;container-orchestration-and-kubernetes&#x2F;">容器编排与 Kubernetes ›</a>
                    
                    
                    
                </div>
            

        

    </div>

    
    
</article>


                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https://blog.kiyoko.io/even.js" ></script>
      
    </body>

</html>
